# Person-reID_GAN
This repository contains the code for our paper [Unlabeled Samples Generated by GAN Improve the Person Re-identification Baseline in vitro](https://arxiv.org/abs/1701.07717).

We are reviewing the necessary codes and updating this repos. Now this repos is incomplete.

![](https://github.com/layumi/layumi.github.io/blob/master/images/fulls/gan.jpg)

### 1.Unsupervised Learning (GAN)
The first stage is to generate fake images by DCGAN.
We used the code provided in https://github.com/carpedm20/DCGAN-tensorflow and modify some hyper-parameters.

For more reference, you can find our modified training code and generating code in `./DCGAN`.

### 2.Semi-supervised Learning 
The second stage is to combine the original data and generated data to train the network.
This repos includes the baseline code and the three different methods in the paper.

| Methods               | Rank@1 | 
| --------              | -----  | 
| resnet52_market.m        | ResNet50 baseline | 
| resnet52_market_K_1.m    | one extra class for generated images|  
| resnet52_market_gan.m    | the proposed method, uniform probability | 
| resnet52_market_pesudo.m | give the most likely label for generated images| 

### Compile Matconvnet



### Train Baseline
1. Add your dataset path into `prepare_data.m` and run it. Make sure the code outputs the right image path.

2. Run `train_id_net_res_market_new.m`.

### Train with generated data
1. Add your generated data path into `prepare_data_gan.m` and run it. It will add generated image path into the original image database.

2. Run `train_id_net_res_market_new.m`.

### Citation
Please cite this paper in your publications if it helps your research:
```
@article{zheng2017unlabeled,
  title={Unlabeled samples generated by gan improve the person re-identification baseline in vitro},
  author={Zheng, Zhedong and Zheng, Liang and Yang, Yi},
  journal={arXiv preprint arXiv:1701.07717},
  year={2017}
}
```
