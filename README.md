# Person-reID_GAN
This repository contains the code for our paper [Unlabeled Samples Generated by GAN Improve the Person Re-identification Baseline in vitro](https://arxiv.org/abs/1701.07717).

We are reviewing the necessary codes and updating this repos. Now this repos is incomplete.

![](https://github.com/layumi/layumi.github.io/blob/master/images/fulls/gan.jpg)

### 1.Unsupervised Learning (GAN)
The first stage is to generate fake images by DCGAN.
We used the code provided in https://github.com/carpedm20/DCGAN-tensorflow and modify some hyper-parameters.

For more reference, you can find our modified training code and generating code in `./DCGAN`.

### 2.Semi-supervised Learning 
The second stage is to combine the original data and generated data to train the network.
This repos includes the baseline code and the three different methods in the paper.

| Models               | Reference | 
| --------              | -----  | 
| resnet52_market.m        | ResNet50 baseline | 
| resnet52_market_K_1.m    | One extra class for generated images|  
| resnet52_market_gan.m    | The proposed method, uniform probability | 
| resnet52_market_pseudo.m | Give the most likely label for generated images| 

* You can find more detailed code for proposed loss in https://github.com/layumi/Person-reID_GAN/blob/master/matlab/vl_nnloss.m#L291.

* Pseudo label is realized in https://github.com/layumi/Person-reID_GAN/blob/master/matlab/%2Bdagnn/Pseudo_Loss.m


### Compile Matconvnet
**(Note that I have included my Matconvnet in this repo, so you do not need to download it again.)**

You just need to uncomment and modify some lines in `gpu_compile.m` and run it in Matlab. Try it~

If you fail in compilation, you may refer to http://www.vlfeat.org/matconvnet/install/

### Dataset
Download [Market1501 Dataset] (http://www.liangzheng.org/Project/project_reid.html)
We take Market1501 as an example in this repos and you can easily extend it to other datasets.

### Train the Baseline code
1. Add your dataset path into `prepare_data.m` and run it. Make sure the code outputs the right image path.

2. Run `train_id_net_res_market_new.m`. 

### Train with generated data
1. Add your generated data path into `prepare_data_gan.m` and run it. It will add generated image path into the original image database.

2. Run `train_id_net_res_market_K_1.m` for training extra-class method.

Or run `train_id_net_res_market_gan.m` for training the proposed method.

Or run `train_id_net_res_market_pseudo.m` for training the pseudo-label method.

### Citation
Please cite this paper in your publications if it helps your research:
```
@article{zheng2017unlabeled,
  title={Unlabeled samples generated by gan improve the person re-identification baseline in vitro},
  author={Zheng, Zhedong and Zheng, Liang and Yang, Yi},
  journal={arXiv preprint arXiv:1701.07717},
  year={2017}
}
```
